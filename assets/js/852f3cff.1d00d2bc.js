"use strict";(self.webpackChunkflamingock=self.webpackChunkflamingock||[]).push([[2920],{1470:(e,n,i)=>{i.d(n,{A:()=>k});var t=i(6540),r=i(4164),o=i(3104),s=i(6347),a=i(205),l=i(7485),d=i(1682),c=i(679);function u(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:i}=e;return(0,t.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:i,default:t}})=>({value:e,label:n,attributes:i,default:t}))}(i);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,i])}function g({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const i=(0,s.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(r),(0,t.useCallback)(e=>{if(!r)return;const n=new URLSearchParams(i.location.search);n.set(r,e),i.replace({...i.location,search:n.toString()})},[r,i])]}function m(e){const{defaultValue:n,queryString:i=!1,groupId:r}=e,o=h(e),[s,l]=(0,t.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!g({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=n.find(e=>e.default)??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:o})),[d,u]=p({queryString:i,groupId:r}),[m,x]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[i,r]=(0,c.Dv)(n);return[i,(0,t.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),j=(()=>{const e=d??m;return g({value:e,tabValues:o})?e:null})();(0,a.A)(()=>{j&&l(j)},[j]);return{selectedValue:s,selectValue:(0,t.useCallback)(e=>{if(!g({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),x(e)},[u,x,o]),tabValues:o}}var x=i(2303);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=i(4848);function b({className:e,block:n,selectedValue:i,selectValue:t,tabValues:s}){const a=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),d=e=>{const n=e.currentTarget,r=a.indexOf(n),o=s[r].value;o!==i&&(l(n),t(o))},c=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const i=a.indexOf(e.currentTarget)+1;n=a[i]??a[0];break}case"ArrowLeft":{const i=a.indexOf(e.currentTarget)-1;n=a[i]??a[a.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:t})=>(0,f.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:e=>{a.push(e)},onKeyDown:c,onClick:d,...t,className:(0,r.A)("tabs__item",j.tabItem,t?.className,{"tabs__item--active":i===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:i}){const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===i);return e?(0,t.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==i}))})}function v(e){const n=m(e);return(0,f.jsxs)("div",{className:(0,r.A)("tabs-container",j.tabList),children:[(0,f.jsx)(b,{...n,...e}),(0,f.jsx)(y,{...n,...e})]})}function k(e){const n=(0,x.A)();return(0,f.jsx)(v,{...e,children:u(e.children)},String(n))}},3575:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>g,frontMatter:()=>l,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"community-edition/ce-mongodb-springdata","title":"MongoDB (Spring Data)","description":"Introduction","source":"@site/docs/community-edition/ce-mongodb-springdata.md","sourceDirName":"community-edition","slug":"/community-edition/ce-mongodb-springdata","permalink":"/docs/1.0.0/community-edition/ce-mongodb-springdata","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/community-edition/ce-mongodb-springdata.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"MongoDB (Spring Data)","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"MongoDB (Java driver)","permalink":"/docs/1.0.0/community-edition/ce-mongodb-java-driver"},"next":{"title":"DynamoDB","permalink":"/docs/1.0.0/community-edition/ce-dynamodb"}}');var r=i(4848),o=i(8453),s=i(1470),a=i(9365);const l={title:"MongoDB (Spring Data)",sidebar_position:3},d=void 0,c={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Editions",id:"editions",level:2},{value:"Why are there two MongoDB Spring Data Community-Edition artifacts?",id:"why-are-there-two-mongodb-spring-data-community-edition-artifacts",level:3},{value:"Get Started",id:"get-started",level:2},{value:"1. Add the required dependencies",id:"1-add-the-required-dependencies",level:3},{value:"2. Configure setup and enable Flamingock runner",id:"2-configure-setup-and-enable-flamingock-runner",level:3},{value:"Configuration overview",id:"configuration-overview",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Properties",id:"properties",level:3},{value:"Full configuration example",id:"full-configuration-example",level:3},{value:"Transaction support",id:"transaction-support",level:2},{value:"Examples",id:"examples",level:2},{value:"\u2705 Best practices",id:"-best-practices",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(n.p,{children:["This section explains how to use the ",(0,r.jsx)(n.strong,{children:"Flamingock Community Edition for MongoDB"})," in applications that rely on ",(0,r.jsx)(n.strong,{children:"Spring Data MongoDB"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["This edition is designed for teams that already use Spring Data to manage their database access and want to include Flamingock as part of their change tracking and execution model. It integrates with ",(0,r.jsx)(n.strong,{children:"Spring Boot"})," and ",(0,r.jsx)(n.strong,{children:"MongoTemplate"}),", handling auditing, distributed locking, and transactional coordination."]}),"\n",(0,r.jsx)(n.p,{children:"Flamingock persists a minimal set of metadata in your MongoDB database:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit logs"})," \u2014 track which changes have been applied"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Distributed locks"})," \u2014 prevent concurrent modifications in distributed deployments"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"editions",children:"Editions"}),"\n",(0,r.jsx)(n.p,{children:"Flamingock provides two editions for Spring Data."}),"\n",(0,r.jsx)(n.h3,{id:"why-are-there-two-mongodb-spring-data-community-edition-artifacts",children:"Why are there two MongoDB Spring Data Community-Edition artifacts?"}),"\n",(0,r.jsx)(n.p,{children:"The only difference is the Java version they target:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"flamingock-ce-mongodb-springdata"})," \u2014 built for the current Spring Data MongoDB 4.x line, which itself requires JDK 17 or newer."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"flamingock-ce-mongodb-springdata-v3-legacy"})," \u2014 kept for teams still on Spring Data 3.x (Spring Boot 2) who must stay on JDK 8 \u2013 11."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Choose the artifact that matches the JDK level of your application today; switching later is as simple as changing the dependency."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Edition Name"}),(0,r.jsx)(n.th,{children:"Spring Data Version"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flamingock-ce-mongodb-springdata-v3-legacy"})}),(0,r.jsx)(n.td,{children:"[3.1.4, 4.0.0)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"flamingock-ce-mongodb-springdata"})}),(0,r.jsx)(n.td,{children:"[4.0.0, 5.0.0)"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"get-started",children:"Get Started"}),"\n",(0,r.jsxs)(n.p,{children:["If you're using ",(0,r.jsx)(n.strong,{children:"Spring Boot"}),", the recommended approach is the ",(0,r.jsx)(n.strong,{children:"automatic setup"})," with ",(0,r.jsx)(n.code,{children:"@EnableFlamingock"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["By annotating your main class with ",(0,r.jsx)(n.code,{children:"@EnableFlamingock"}),", Flamingock will:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Automatically detect and inject Spring components (",(0,r.jsx)(n.code,{children:"ApplicationContext"}),", ",(0,r.jsx)(n.code,{children:"ApplicationEventPublisher"}),", etc.)"]}),"\n",(0,r.jsx)(n.li,{children:"Pick up configuration from the native Spring Boot config file"}),"\n",(0,r.jsxs)(n.li,{children:["Create and register a runner bean (either ",(0,r.jsx)(n.code,{children:"ApplicationRunner"})," or ",(0,r.jsx)(n.code,{children:"InitializingBean"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Process the setup configuration from the annotation"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"1-add-the-required-dependencies",children:"1. Add the required dependencies"}),"\n",(0,r.jsxs)(s.A,{groupId:"build_enable",children:[(0,r.jsx)(a.A,{value:"gradle",label:"Gradle",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kotlin",children:'implementation(platform("io.flamingock:flamingock-ce-bom:$flamingockVersion"))\nimplementation("io.flamingock:flamingock-ce-mongodb-springdata")\n'})})}),(0,r.jsx)(a.A,{value:"maven",label:"Maven",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n  <groupId>io.flamingock</groupId>\n  <artifactId>flamingock-ce-mongodb-springdata</artifactId>\n  <version>${flamingock.version}</version>\n</dependency>\n<dependency>\n  <groupId>io.flamingock</groupId>\n  <artifactId>springboot-integration-v3</artifactId>\n  <version>${flamingock.version}</version>\n</dependency>\n"})})})]}),"\n",(0,r.jsx)(n.admonition,{title:"Legacy Support",type:"info",children:(0,r.jsxs)(n.p,{children:["If your project uses ",(0,r.jsx)(n.strong,{children:"Spring Data 3.x"})," and ",(0,r.jsx)(n.strong,{children:"Spring Boot 2.x"}),", use the ",(0,r.jsx)(n.code,{children:"flamingock-ce-mongodb-springdata-v3-legacy"})," edition instead."]})}),"\n",(0,r.jsx)(n.h3,{id:"2-configure-setup-and-enable-flamingock-runner",children:"2. Configure setup and enable Flamingock runner"}),"\n",(0,r.jsx)(n.p,{children:"Choose one of the following options based on your preferred integration style:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automatic setup"})," (recommended): Annotate your main class with ",(0,r.jsx)(n.code,{children:"@EnableFlamingock"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Manual builder-based setup"}),": Use ",(0,r.jsx)(n.code,{children:"@EnableFlamingock"})," with ",(0,r.jsx)(n.code,{children:"setup = SetupType.BUILDER"})," and manually register the Flamingock runner bean"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"automatic_builder",children:[(0,r.jsx)(a.A,{value:"automatic",label:"Automatic",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@EnableFlamingock(\n    stages = {\n        @Stage(location = "com.yourapp.changes")\n    }\n)\n@SpringBootApplication\npublic class MyApp {\n  public static void main(String[] args) {\n    SpringApplication.run(MyApp.class, args);\n  }\n}\n'})})}),(0,r.jsx)(a.A,{value:"builder",label:"Builder",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@EnableFlamingock(\n    setup = SetupType.BUILDER,\n    stages = {\n        @Stage(location = "com.yourapp.changes")\n    }\n)\n@Configuration\npublic class FlamingockConfig {\n\n    @Bean\n    public ApplicationRunner flamingockRunner(ApplicationContext context,\n                                               ApplicationEventPublisher publisher,\n                                               MongoTemplate template) {\n        FlamingockBuilder builder = Flamingock.builder()\n            .addDependency(context)\n            .addDependency(publisher)\n            .addDependency(template)\n            .setProperty("mongodb.databaseName", "flamingock-db");\n        return SpringbootUtil.toApplicationRunner(builder.build());\n    }\n}\n'})})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configuration-overview",children:"Configuration overview"}),"\n",(0,r.jsx)(n.p,{children:"Flamingock\u2019s MongoDB Spring Data edition requires two types of inputs:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dependencies"}),": These are required runtime components, such as ",(0,r.jsx)(n.code,{children:"MongoTemplate"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Properties"}),": These configure Flamingock\u2019s internal behavior and are typically declared in the Spring configuration file or via the builder."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(n.p,{children:["These must be available in the Spring context (when using automatic setup with ",(0,r.jsx)(n.code,{children:"@Flamingock"}),") or registered via ",(0,r.jsx)(n.code,{children:".addDependency(...)"})," when using the builder setup."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Required"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"org.springframework.data.mongodb.core.MongoTemplate"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"Yes"}),(0,r.jsx)(n.td,{children:"Must be declared as a Spring bean."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"org.springframework.context.ApplicationContext"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"Yes"}),(0,r.jsx)(n.td,{children:"Auto-injected by Spring Boot."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"org.springframework.context.ApplicationEventPublisher"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"Yes"}),(0,r.jsx)(n.td,{children:"Auto-injected by Spring Boot."})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["Spring Boot will typically auto-configure ",(0,r.jsx)(n.code,{children:"MongoTemplate"})," for you."]})}),"\n",(0,r.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default Value"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb.autoCreate"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Whether Flamingock should automatically create required collections and indexes."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb.readConcern"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"String"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"MAJORITY"'})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Controls the level of isolation for read operations."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb. writeConcern.w"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"String or int"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"MAJORITY"'})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Write acknowledgment. Specifies how many MongoDB nodes must confirm the write."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb. writeConcern.journal"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Whether the write must be written to the on-disk journal before acknowledgment."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb. writeConcern.wTimeout"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Duration"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Duration. ofSeconds(1)"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Maximum time to wait for the write concern to be fulfilled."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb. readPreference"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ReadPreference Level"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ReadPreferenceLevel. PRIMARY"})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Specifies which MongoDB node to read from."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb. auditRepositoryName"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"String"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"flamingockAuditLogs"'})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Name of the collection used to store applied changes. Most users should keep the default value."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongodb. lockRepositoryName"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"String"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"flamingockLock"'})}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Name of the collection used for distributed locking. Most users should keep the default value."})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["It's ",(0,r.jsx)(n.strong,{children:"strongly recommended keeping the default MongoDB configuration values provided by Flamingock"})," \u2014 especially in production environments. These defaults are carefully chosen to guarantee ",(0,r.jsx)(n.strong,{children:"maximum consistency, durability, and safety"}),", which are fundamental to Flamingock\u2019s audit and rollback guarantees."]})}),"\n",(0,r.jsx)(n.p,{children:"Overriding them is only appropriate in limited cases (e.g., testing or local development). If you choose to modify these settings, you assume full responsibility for maintaining the integrity and consistency of your system."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"full-configuration-example",children:"Full configuration example"}),"\n",(0,r.jsx)(n.p,{children:"The following example shows how to configure Flamingock with both required and optional properties. It demonstrates how to override index creation, and read/write behaviour. This level of configuration is useful when you need to customise Flamingock's behaviour to match the consistency and durability requirements of your deployment."}),"\n",(0,r.jsxs)(s.A,{groupId:"automatic_builder",children:[(0,r.jsx)(a.A,{value:"automatic",label:"Automatic",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"flamingock:\n  mongodb:\n    databaseName: flamingock-db\n    autoCreate: true\n    readConcern: MAJORITY\n    writeConcern:\n      w: MAJORITY\n      journal: true\n      wTimeout: 1s\n    readPreference: PRIMARY\n"})})}),(0,r.jsx)(a.A,{value:"builder",label:"Builder",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'FlamingockBuilder builder = Flamingock.builder()\n    .addDependency(applicationContext)\n    .addDependency(applicationEventPublisher)\n    .addDependency(mongoTemplate)\n    .setProperty("mongodb.databaseName", "flamingock-db")\n    .setProperty("mongodb.autoCreate", true)\n    .setProperty("mongodb.readConcern", "MAJORITY")\n    .setProperty("mongodb.writeConcern.w", "MAJORITY")\n    .setProperty("mongodb.writeConcern.journal", true)\n    .setProperty("mongodb.writeConcern.wTimeout", Duration.ofSeconds(1))\n    .setProperty("mongodb.readPreference", ReadPreferenceLevel.PRIMARY);\n'})})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"transaction-support",children:"Transaction support"}),"\n",(0,r.jsxs)(n.p,{children:["If your MongoDB deployment supports transactions, Flamingock can execute Spring Data operations within a transactional session \u2014 ",(0,r.jsx)(n.strong,{children:"as long as the underlying MongoDB driver and Spring Data version allow it"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["To benefit from transactional execution, simply declare your ",(0,r.jsx)(n.code,{children:"@Execution"})," method to receive a ",(0,r.jsx)(n.code,{children:"MongoTemplate"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@Execution\npublic void change(MongoTemplate mongoTemplate) {\n    // This will run inside a transaction\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Internally, Flamingock will manage the transaction lifecycle and ensure all operations performed through ",(0,r.jsx)(n.code,{children:"MongoTemplate"})," are part of a single, atomic transaction. If anything fails, the changes and the audit log will be rolled back."]}),"\n",(0,r.jsxs)(n.p,{children:["There is no need to manually manage a ",(0,r.jsx)(n.code,{children:"ClientSession"})," when using Spring Data.\nFlamingock integrates with Spring\u2019s transaction management infrastructure to coordinate the session for you."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/1.0.0/flamingock-library-config/transactions",children:"Transactions"})," page for general behavior and when to use ",(0,r.jsx)(n.code,{children:"transactional = false"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(n.p,{children:["You can find practical examples in the official GitHub repository:",(0,r.jsx)(n.br,{}),"\n","\ud83d\udc49 ",(0,r.jsx)(n.a,{href:"https://github.com/flamingock/flamingock-examples/mongodb",children:"github.com/flamingock/flamingock-examples/mongodb"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-best-practices",children:"\u2705 Best practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Use Flamingock\u2019s default consistency settings (",(0,r.jsx)(n.code,{children:"writeConcern"}),", ",(0,r.jsx)(n.code,{children:"readConcern"}),", ",(0,r.jsx)(n.code,{children:"readPreference"}),") in production"]}),(0,r.jsx)(n.br,{}),"\n","These defaults are ",(0,r.jsx)(n.strong,{children:"strictly selected to guarantee strong consistency, durability, and fault-tolerance"}),", which are fundamental to Flamingock\u2019s execution guarantees.",(0,r.jsx)(n.br,{}),"\n","Overriding them is ",(0,r.jsx)(n.strong,{children:"strongly discouraged in production environments"}),", as it can compromise the integrity of audit logs and distributed coordination."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Use the default repository names (",(0,r.jsx)(n.code,{children:"flamingockAuditLogs"}),", ",(0,r.jsx)(n.code,{children:"flamingockLock"}),") unless you have a strong reason to change them"]}),(0,r.jsx)(n.br,{}),"\n","The default names are chosen to avoid collisions and clearly identify Flamingock-managed collections. Overriding them is supported but rarely necessary."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Keep ",(0,r.jsx)(n.code,{children:"indexCreation"})," enabled unless your deployment restricts index creation at runtime"]}),(0,r.jsx)(n.br,{}),"\n","This setting ensures that Flamingock creates and maintains the required indexes to enforce audit integrity and locking guarantees.",(0,r.jsx)(n.br,{}),"\n","Disable this only if your application does not have the necessary permissions to create indexes \u2014 and only if you manage the required indexes manually."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Always match the edition to your Spring Data / MongoDB driver version"})}),"\n"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var t=i(6540);const r={},o=t.createContext(r);function s(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(o.Provider,{value:n},e.children)}},9365:(e,n,i)=>{i.d(n,{A:()=>s});i(6540);var t=i(4164);const r={tabItem:"tabItem_Ymn6"};var o=i(4848);function s({children:e,hidden:n,className:i}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,t.A)(r.tabItem,i),hidden:n,children:e})}}}]);