"use strict";(self.webpackChunkflamingock=self.webpackChunkflamingock||[]).push([[4554],{2317:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"flamingock-library-config/context-and-dependencies","title":"Context and dependencies","description":"Flamingock provides a sophisticated dependency injection system that automatically resolves dependencies for ChangeUnits from multiple sources. Understanding this system is crucial for building maintainable and well-structured changes.","source":"@site/docs/flamingock-library-config/context-and-dependencies.md","sourceDirName":"flamingock-library-config","slug":"/flamingock-library-config/context-and-dependencies","permalink":"/docs/flamingock-library-config/context-and-dependencies","draft":false,"unlisted":false,"editUrl":"https://github.com/flamingock/flamingock-java/docs/flamingock-library-config/context-and-dependencies.md","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"title":"Context and dependencies","sidebar_position":20},"sidebar":"tutorialSidebar","previous":{"title":"Setup & Stages","permalink":"/docs/flamingock-library-config/setup-and-stages"},"next":{"title":"Lock","permalink":"/docs/flamingock-library-config/lock"}}');var t=i(4848),a=i(8453);const r={title:"Context and dependencies",sidebar_position:20},o="Context and dependencies",c={},d=[{value:"What is the context?",id:"what-is-the-context",level:2},{value:"Dependency resolution hierarchy",id:"dependency-resolution-hierarchy",level:2},{value:"How it works in practice",id:"how-it-works-in-practice",level:3},{value:"Providing dependencies",id:"providing-dependencies",level:2},{value:"Target system dependencies",id:"target-system-dependencies",level:3},{value:"Global dependencies",id:"global-dependencies",level:3},{value:"Framework dependencies",id:"framework-dependencies",level:3},{value:"Best practices",id:"best-practices",level:2},{value:"Scope dependencies appropriately",id:"scope-dependencies-appropriately",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"context-and-dependencies",children:"Context and dependencies"})}),"\n",(0,t.jsx)(n.p,{children:"Flamingock provides a sophisticated dependency injection system that automatically resolves dependencies for ChangeUnits from multiple sources. Understanding this system is crucial for building maintainable and well-structured changes."}),"\n",(0,t.jsx)(n.h2,{id:"what-is-the-context",children:"What is the context?"}),"\n",(0,t.jsx)(n.p,{children:"The context is Flamingock's dependency container that holds all the dependencies your ChangeUnits might need. It's organized hierarchically, allowing for proper scoping and isolation of dependencies."}),"\n",(0,t.jsx)(n.p,{children:"Contexts can contain:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"System connectors (databases, message queues, storage services, APIs)"}),"\n",(0,t.jsx)(n.li,{children:"Configuration properties and objects"}),"\n",(0,t.jsx)(n.li,{children:"Service instances and business logic components"}),"\n",(0,t.jsx)(n.li,{children:"Framework-specific beans (like Spring components)"}),"\n",(0,t.jsx)(n.li,{children:"Custom utilities and helpers"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"dependency-resolution-hierarchy",children:"Dependency resolution hierarchy"}),"\n",(0,t.jsxs)(n.p,{children:["Flamingock uses a ",(0,t.jsx)(n.strong,{children:"hierarchical resolution strategy"})," that searches for dependencies in this order:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Target system context"})," - Dependencies provided by the specific target system. For more information, see ",(0,t.jsx)(n.a,{href:"/docs/target-systems/introduction",children:"Target systems"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"General application context"})," - Shared dependencies registered globally directly in the builder"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Framework context"})," - When using Spring Boot, beans from the Spring container. For more information, see ",(0,t.jsx)(n.a,{href:"/docs/frameworks/springboot-integration/introduction",children:"Spring Boot integration"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This approach ensures that system-specific dependencies are properly scoped while allowing shared utilities to be available everywhere."}),"\n",(0,t.jsx)(n.h3,{id:"how-it-works-in-practice",children:"How it works in practice"}),"\n",(0,t.jsxs)(n.p,{children:["When a ChangeUnit needs a dependency, Flamingock follows a specific search pattern. For example, imagine your ChangeUnit requires a ",(0,t.jsx)(n.code,{children:"NotificationService"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Scenario 1"}),": If the Kafka target system provides its own notification service specifically for event streaming, and your ChangeUnit belongs to that Kafka target system, Flamingock will use the Kafka-specific notification service. The target system context always wins."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Scenario 2"}),": If your MongoDB target system doesn't provide a notification service, but you've registered one globally in Flamingock's builder, the ChangeUnit will receive that global notification service. Flamingock searches the target system first, doesn't find it, then falls back to the global context."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Scenario 3"}),": In a Spring Boot application, if neither the target system nor the global context provides the dependency, Flamingock will look for a Spring bean of that type. This allows seamless integration with your existing Spring components."]}),"\n",(0,t.jsx)(n.p,{children:"This hierarchy ensures that specialized implementations (like a Kafka-optimized notification service) are used when available, while still allowing shared services to be accessible across all ChangeUnits."}),"\n",(0,t.jsx)(n.h2,{id:"providing-dependencies",children:"Providing dependencies"}),"\n",(0,t.jsx)(n.h3,{id:"target-system-dependencies",children:"Target system dependencies"}),"\n",(0,t.jsx)(n.p,{children:"Every target system provides two ways to add dependencies:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Specific methods"})," - Each concrete implementation offers ",(0,t.jsx)(n.code,{children:".withXXX()"})," methods for common dependencies:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'MongoSyncTargetSystem mongoTarget = new MongoSyncTargetSystem("user-db")\n    .withDatabase(database)      // MongoDB-specific method\n    .withMongoClient(client);    // MongoDB-specific method\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Generic methods"})," - All target systems (including DefaultTargetSystem) support generic dependency injection:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'DefaultTargetSystem kafkaTarget = new DefaultTargetSystem("events")\n    .addDependency(kafkaProducer)\n    .addDependency("notification-service", notificationService)\n    .setProperty("batch.size", 1000);\n'})}),"\n",(0,t.jsx)(n.p,{children:"This flexibility allows DefaultTargetSystem to inject any dependencies needed for non-transactional systems, while specialized target systems provide convenience methods for their common dependencies."}),"\n",(0,t.jsx)(n.h3,{id:"global-dependencies",children:"Global dependencies"}),"\n",(0,t.jsx)(n.p,{children:"You can register dependencies globally to make them available to all ChangeUnits:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"Flamingock.builder()\n    .addDependency(userService)\n    .addDependency(emailService)\n    .addDependency(configurationProperties)\n    .addTargetSystems(mongoTarget)\n    .build();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"framework-dependencies",children:"Framework dependencies"}),"\n",(0,t.jsx)(n.p,{children:"When using frameworks like Spring Boot, Flamingock automatically accesses beans from the framework container:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Service\npublic class UserService {\n    // This service is automatically available to ChangeUnits\n}\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"Remember that target system contexts are isolated. Dependencies in one target system aren't available to ChangeUnits in another target system."})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best practices"}),"\n",(0,t.jsx)(n.h3,{id:"scope-dependencies-appropriately",children:"Scope dependencies appropriately"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Target system specific"}),": System connectors (DB, Kafka, S3, etc.), system-specific configurations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Global"}),": Shared services, utilities, application-wide configuration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Framework"}),": Let Spring manage beans, services, and repositories"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Key takeaway"}),": Flamingock's hierarchical dependency resolution provides flexibility while maintaining clear separation of concerns. Use target system contexts for system-specific dependencies and global context for shared resources."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(6540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);