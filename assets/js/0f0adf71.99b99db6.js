"use strict";(self.webpackChunkflamingock=self.webpackChunkflamingock||[]).push([[2250],{1470:(e,n,t)=>{t.d(n,{A:()=>L});var i=t(6540),a=t(4164),r=t(3104),s=t(6347),l=t(205),o=t(7485),c=t(1682),d=t(679);function u(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,i.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:t,default:i}})=>({value:e,label:n,attributes:t,default:i}))}(t);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function h({value:e,tabValues:n}){return n.some(n=>n.value===e)}function g({queryString:e=!1,groupId:n}){const t=(0,s.W6)(),a=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(a),(0,i.useCallback)(e=>{if(!a)return;const n=new URLSearchParams(t.location.search);n.set(a,e),t.replace({...t.location,search:n.toString()})},[a,t])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,r=p(e),[s,o]=(0,i.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r})),[c,u]=g({queryString:t,groupId:a}),[m,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,a]=(0,d.Dv)(n);return[t,(0,i.useCallback)(e=>{n&&a.set(e)},[n,a])]}({groupId:a}),v=(()=>{const e=c??m;return h({value:e,tabValues:r})?e:null})();(0,l.A)(()=>{v&&o(v)},[v]);return{selectedValue:s,selectValue:(0,i.useCallback)(e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),f(e)},[u,f,r]),tabValues:r}}var f=t(2303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(4848);function x({className:e,block:n,selectedValue:t,selectValue:i,tabValues:s}){const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,r.a_)(),c=e=>{const n=e.currentTarget,a=l.indexOf(n),r=s[a].value;r!==t&&(o(n),i(r))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:i})=>(0,b.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...i,className:(0,a.A)("tabs__item",v.tabItem,i?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function S({lazy:e,children:n,selectedValue:t}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===t);return e?(0,i.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function j(e){const n=m(e);return(0,b.jsxs)("div",{className:(0,a.A)("tabs-container",v.tabList),children:[(0,b.jsx)(x,{...n,...e}),(0,b.jsx)(S,{...n,...e})]})}function L(e){const n=(0,f.A)();return(0,b.jsx)(j,{...e,children:u(e.children)},String(n))}},3219:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"flamingock-library-config/events","title":"Events","description":"This guide provides a comprehensive explanation of how Flamingock events function.","source":"@site/docs/flamingock-library-config/events.md","sourceDirName":"flamingock-library-config","slug":"/flamingock-library-config/events","permalink":"/docs/1.0.0/flamingock-library-config/events","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/flamingock-library-config/events.md","tags":[],"version":"current","sidebarPosition":90,"frontMatter":{"sidebar_position":90},"sidebar":"tutorialSidebar","previous":{"title":"Distributed lock configuration","permalink":"/docs/1.0.0/flamingock-library-config/lock-configuration"},"next":{"title":"Transactions","permalink":"/docs/1.0.0/flamingock-library-config/transactions"}}');var a=t(4848),r=t(8453),s=t(1470),l=t(9365);const o={sidebar_position:90},c="Events",d={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Type of events",id:"type-of-events",level:2},{value:"Get started",id:"get-started",level:2},{value:"Standalone basic example",id:"standalone-basic-example",level:2},{value:"Builder",id:"builder",level:3},{value:"Listener",id:"listener",level:3},{value:"Spring-based basic example",id:"spring-based-basic-example",level:2},{value:"Listeners",id:"listeners",level:3}];function p(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"events",children:"Events"})}),"\n",(0,a.jsx)(n.p,{children:"This guide provides a comprehensive explanation of how Flamingock events function."}),"\n",(0,a.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsx)(n.p,{children:"Flamingock utilizes events to notify the main application about the current state of the Flamingock process, as well as the eventual outcome of its execution."}),"\n",(0,a.jsx)(n.p,{children:"The event-handling approach differs significantly depending on the type of runner being used:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["For Spring-based applications, Flamingock leverages the ",(0,a.jsx)(n.code,{children:"ApplicationEventPublisher"}),", which is provided during the build process."]}),"\n",(0,a.jsx)(n.li,{children:"For standalone applications, Flamingock requires an explicit event handler to be defined at build time."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Flamingock offers event handling capabilities for both Pipelines and Stages."}),"\n",(0,a.jsx)(n.h2,{id:"type-of-events",children:"Type of events"}),"\n",(0,a.jsx)(n.p,{children:"Flamingock emits three types of events:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Start Event"}),": Triggered just before the migration process begins, following successful validation."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Success Event"}),": Emitted upon successful completion of the migration. This indicates that no unhandled exceptions occurred, or that any errors were either properly handled or associated changeLogs were marked with 'Fail' as false."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Failure Event"}),": Emitted when a change log fails and the failure is not handled, as described above."]}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsx)(n.p,{children:"The Success and Failure events are mutually exclusive, only one of them will be raised for a given migration execution."})}),"\n",(0,a.jsx)(n.h2,{id:"get-started",children:"Get started"}),"\n",(0,a.jsx)(n.p,{children:"Each runner's documentation page provides the necessary information for using events in accordance with that runner's specific implementation."}),"\n",(0,a.jsx)(n.h2,{id:"standalone-basic-example",children:"Standalone basic example"}),"\n",(0,a.jsx)(n.p,{children:"In the Flamingock builder, you must configure the events you intend to use and implement the corresponding listeners."}),"\n",(0,a.jsx)(n.h3,{id:"builder",children:"Builder"}),"\n",(0,a.jsxs)(s.A,{groupId:"languages",children:[(0,a.jsx)(l.A,{value:"java",label:"Java",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"    FlamingockStandalone.local()\n        .setPipelineStartedListener(new PipelineStartedListener())\n        .setPipelineCompletedListener(new PipelineCompletedListener())\n        .setPipelineFailedListener(new PipelineFailedListener())\n        .setStageStartedListener(new StageStartedListener())\n        .setStageCompletedListener(new StageCompletedListener())\n        .setStageFailedListener(new StageFailedListener())\n        .build()\n        .run();\n"})})}),(0,a.jsx)(l.A,{value:"kotlin",label:"Kotlin",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:"    FlamingockStandalone.local()\n        .setPipelineStartedListener(PipelineStartedListener())\n        .setPipelineCompletedListener(PipelineCompletedListener())\n        .setPipelineFailedListener(PipelineFailedListener())\n        .setStageStartedListener(StageStartedListener())\n        .setStageCompletedListener(StageCompletedListener())\n        .setStageFailedListener(StageFailedListener())\n        .build()\n        .run()\n"})})})]}),"\n",(0,a.jsx)(n.h3,{id:"listener",children:"Listener"}),"\n",(0,a.jsxs)(s.A,{groupId:"languages",children:[(0,a.jsx)(l.A,{value:"java",label:"Java",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"  public class StageCompletedListener implements Consumer<IStageCompletedEvent> {\n\n  public static int executed = 0;\n  @Override\n  public void accept(IStageCompletedEvent iStageCompletedEvent) {\n      executed++;\n  }\n  }\n"})})}),(0,a.jsx)(l.A,{value:"kotlin",label:"Kotlin",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:"class StageCompletedListener : (IStageCompletedEvent) -> Unit {\n\n  companion object {\n      var executed = 0\n  }\n\n  override fun invoke(iStageCompletedEvent: IStageCompletedEvent) {\n      executed++\n  }\n}\n"})})})]}),"\n",(0,a.jsx)(n.h2,{id:"spring-based-basic-example",children:"Spring-based basic example"}),"\n",(0,a.jsx)(n.h3,{id:"listeners",children:"Listeners"}),"\n",(0,a.jsxs)(s.A,{groupId:"languages",children:[(0,a.jsx)(l.A,{value:"java",label:"Java",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"  @Bean\n  public PipelineStartedListener startFlamingockListener() {\n      return new PipelineStartedListener();\n  }\n\n  @Bean\n  public PipelineCompletedListener successFlamingockListener() {\n      return new PipelineCompletedListener();\n  }\n\n  @Bean\n  public PipelineFailedListener sailedFlamingockListener() {\n      return new PipelineFailedListener();\n  }\n\n  @Bean\n  public StageStartedListener stageStartedListener() {return new StageStartedListener();}\n\n  @Bean\n  public StageCompletedListener stageCompletedListener() {return new StageCompletedListener();}\n\n  @Bean\n  public StageFailedListener stageFailedListener() {return new StageFailedListener();}\n"})})}),(0,a.jsx)(l.A,{value:"kotlin",label:"Kotlin",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:"    import org.springframework.context.annotation.Bean\n\n    @Bean\n    fun startFlamingockListener(): PipelineStartedListener {\n        return PipelineStartedListener()\n    }\n\n    @Bean\n    fun successFlamingockListener(): PipelineCompletedListener {\n        return PipelineCompletedListener()\n    }\n\n    @Bean\n    fun sailedFlamingockListener(): PipelineFailedListener {\n        return PipelineFailedListener()\n    }\n\n    @Bean\n    fun stageStartedListener(): StageStartedListener {\n        return StageStartedListener()\n    }\n\n    @Bean\n    fun stageCompletedListener(): StageCompletedListener {\n        return StageCompletedListener()\n    }\n\n    @Bean\n    fun stageFailedListener(): StageFailedListener {\n        return StageFailedListener()\n    }\n"})})})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(6540);const a={},r=i.createContext(a);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:n},e.children)}},9365:(e,n,t)=>{t.d(n,{A:()=>s});t(6540);var i=t(4164);const a={tabItem:"tabItem_Ymn6"};var r=t(4848);function s({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)(a.tabItem,t),hidden:n,children:e})}}}]);