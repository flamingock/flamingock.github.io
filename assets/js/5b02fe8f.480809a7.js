"use strict";(self.webpackChunkflamingock=self.webpackChunkflamingock||[]).push([[7033],{7418:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"target-systems/dynamodb-target-system","title":"DynamoDB","description":"The DynamoDB target system (DynamoDBTargetSystem) enables Flamingock to apply changes to Amazon DynamoDB using the AWS SDK for Java. As a transactional target system, it supports automatic rollback through DynamoDB\'s transaction capabilities with TransactWriteItems.","source":"@site/docs/target-systems/dynamodb-target-system.md","sourceDirName":"target-systems","slug":"/target-systems/dynamodb-target-system","permalink":"/docs/target-systems/dynamodb-target-system","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/target-systems/dynamodb-target-system.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"DynamoDB","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"SQL","permalink":"/docs/target-systems/sql-target-system"},"next":{"title":"Couchbase","permalink":"/docs/target-systems/couchbase-target-system"}}');var s=t(4848),i=t(8453);const r={title:"DynamoDB",sidebar_position:4},o="DynamoDB Target System",c={},d=[{value:"Minimum recommended setup",id:"minimum-recommended-setup",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Required dependencies",id:"required-dependencies",level:3},{value:"Configuration example",id:"configuration-example",level:2},{value:"Transactional support",id:"transactional-support",level:2},{value:"Available dependencies in ChangeUnits",id:"available-dependencies-in-changeunits",level:2},{value:"Next steps",id:"next-steps",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"dynamodb-target-system",children:"DynamoDB Target System"})}),"\n",(0,s.jsxs)(n.p,{children:["The DynamoDB target system (",(0,s.jsx)(n.code,{children:"DynamoDBTargetSystem"}),") enables Flamingock to apply changes to Amazon DynamoDB using the AWS SDK for Java. As a transactional target system, it supports automatic rollback through DynamoDB's transaction capabilities with ",(0,s.jsx)(n.code,{children:"TransactWriteItems"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"minimum-recommended-setup",children:"Minimum recommended setup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'DynamoDBTargetSystem dynamoTarget = new DynamoDBTargetSystem("inventory-database")\n    .withDynamoDBClient(dynamoDbClient);\n'})}),"\n",(0,s.jsx)(n.p,{children:"While dependencies can be provided through the global context, we highly recommend injecting them directly at the target system level. This provides clearer scoping, better isolation between systems, and makes dependencies explicit and easier to track."}),"\n",(0,s.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(n.p,{children:["Following Flamingock's ",(0,s.jsx)(n.a,{href:"../flamingock-library-config/target-system-configuration.md#dependency-resolution-hierarchy",children:"dependency resolution hierarchy"}),", you can provide dependencies via direct injection or global context."]}),"\n",(0,s.jsx)(n.h3,{id:"required-dependencies",children:"Required dependencies"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Dependency"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DynamoDbClient"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:".withDynamoDBClient(client)"})}),(0,s.jsxs)(n.td,{children:["AWS DynamoDB client - ",(0,s.jsx)(n.strong,{children:"required"})," for both ChangeUnit execution and transaction management"]})]})})]}),"\n",(0,s.jsxs)(n.p,{children:["Remember: If not provided directly via ",(0,s.jsx)(n.code,{children:".withXXX()"}),", Flamingock searches the global context. If still not found:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Required dependencies"})," will throw an exception"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuration-example",children:"Configuration example"}),"\n",(0,s.jsx)(n.p,{children:"Here's a comprehensive example showing dependency resolution:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// Target system with specific dependencies\nDynamoDBTargetSystem dynamoTarget = new DynamoDBTargetSystem("inventory-database")\n    .withDynamoDBClient(inventoryDynamoClient)  // Target-specific client\n    .addDependency(inventoryService);           // Custom service for this target\n\n// Global context with different dependencies\nFlamingock.builder()\n    .addDependency(defaultDynamoClient)         // Different client in global\n    .addDependency(emailService)                // Available to all targets\n    .addTargetSystems(dynamoTarget)\n    .build();\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'What gets resolved for ChangeUnits in "inventory-database":'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DynamoDbClient"}),": Uses ",(0,s.jsx)(n.code,{children:"inventoryDynamoClient"})," (from target system, not ",(0,s.jsx)(n.code,{children:"defaultDynamoClient"})," from global)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"InventoryService"}),": Available from target system context"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"EmailService"}),": Available from global context"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The target system context always takes precedence, ensuring proper isolation between different systems."}),"\n",(0,s.jsx)(n.h2,{id:"transactional-support",children:"Transactional support"}),"\n",(0,s.jsxs)(n.p,{children:["For a ChangeUnit to leverage DynamoDB's transactional capabilities, it must use the ",(0,s.jsx)(n.code,{children:"TransactWriteItemsEnhancedRequest.Builder"})," parameter. Flamingock uses the injected ",(0,s.jsx)(n.code,{children:"DynamoDbClient"})," dependency to create and manage this builder's lifecycle - creating it before execution and executing the transaction with all operations on success."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@TargetSystem("inventory-database")\n@ChangeUnit(id = "update-inventory", order = "001")\npublic class UpdateInventory {\n    \n    @Execution\n    public void execution(DynamoDbClient client, \n                         TransactWriteItemsEnhancedRequest.Builder txBuilder) {\n        // The transaction builder is required for transactional execution\n        // Flamingock uses the target system\'s DynamoDbClient to handle transaction operations\n        // and manages transaction creation, execution, and rollback automatically\n        \n        DynamoDbEnhancedClient enhancedClient = DynamoDbEnhancedClient.builder()\n            .dynamoDbClient(client)\n            .build();\n        \n        DynamoDbTable<Product> table = enhancedClient.table("products", \n            TableSchema.fromBean(Product.class));\n        \n        // Add operations to the transaction\n        txBuilder.addPutItem(table, new Product("123", "Updated Product"));\n        txBuilder.addDeleteItem(table, Key.builder().partitionValue("456").build());\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"How transactions work:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Builder creation"}),": Flamingock uses the target system's ",(0,s.jsx)(n.code,{children:"DynamoDbClient"})," to create a ",(0,s.jsx)(n.code,{children:"TransactWriteItemsEnhancedRequest.Builder"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Transaction management"}),": The same ",(0,s.jsx)(n.code,{children:"DynamoDbClient"})," executes the transaction with all accumulated operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lifecycle"}),": Flamingock automatically creates the builder, executes the transaction on success, or handles rollback on failure"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Without the ",(0,s.jsx)(n.code,{children:"TransactWriteItemsEnhancedRequest.Builder"})," parameter, operations will execute but won't participate in transactions."]}),"\n",(0,s.jsx)(n.h2,{id:"available-dependencies-in-changeunits",children:"Available dependencies in ChangeUnits"}),"\n",(0,s.jsxs)(n.p,{children:["Your ChangeUnits can inject DynamoDB-specific dependencies like ",(0,s.jsx)(n.code,{children:"DynamoDbClient"})," and ",(0,s.jsx)(n.code,{children:"TransactWriteItemsEnhancedRequest.Builder"}),", but are not limited to these. Any dependency can be added to the target system context via ",(0,s.jsx)(n.code,{children:".addDependency()"}),", taking precedence over global dependencies."]}),"\n",(0,s.jsxs)(n.p,{children:["For more details on dependency resolution, see ",(0,s.jsx)(n.a,{href:"/docs/flamingock-library-config/context-and-dependencies",children:"Context and dependencies"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Learn about ",(0,s.jsx)(n.a,{href:"../flamingock-library-config/target-system-configuration.md",children:"Target system configuration"})]}),"\n",(0,s.jsxs)(n.li,{children:["Explore ",(0,s.jsx)(n.a,{href:"/docs/change-units/introduction",children:"ChangeUnits"})]}),"\n",(0,s.jsxs)(n.li,{children:["See ",(0,s.jsx)(n.a,{href:"https://github.com/flamingock/flamingock-examples/tree/master/dynamodb",children:"DynamoDB examples"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var a=t(6540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);